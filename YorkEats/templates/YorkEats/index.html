{% extends "yorkeats/layout.html" %}

{% load static %}
{% block body %}
    <script src="{% static 'home.js' %}"></script>
    <h4 style="text-align: center;">Currently Open</h4>

    <div class="container-sm">
      <div id="form-grid" class="row" style="height: 300px; overflow-y:scroll;">
        <div class="col">
          <p>Dining</p>
          {% for location in locations %}
          {% if location != "" and location != "Unknown location" %}
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="{{location}}">
            <label class="form-check-label" for="{{location}}">
              {{location}}
            </label>
          </div>
          {% endif %}
          {% endfor %}
        </div>
        <div class="col">
          <p>Cuisine</p>
          {% for cuisine in cuisines %}
          {% if cuisine != "" and cuisine != "No genre of cuisine provided" %}
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="{{cuisine}}">
            <label class="form-check-label" for="{{cuisine}}">
              {{cuisine}}
            </label>
          </div>
          {% endif %}
          {% endfor %}
        </div>
        <div class="col">
          <p>Payment Type</p>
          {% for options in payment_options %}
          {% if options != "" and options != "No payment options provided" %}
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="{{options}}">
            <label class="form-check-label" for="{{options}}">
              {{options}}
            </label>
          </div>
          {% endif %}
          {% endfor %}
        </div>
        <div class="col">
          <p>Dietary</p>
          {% for options in dietary_options %}
          {% if options != "" and options != "No dietary options provided" %}
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="{{options}}">
            <label class="form-check-label" for="{{options}}">
              {{options}}
            </label>
          </div>
          {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
    <div class="row row-cols-3 justify-content-center" style="width: 99.7vw;" id="card-row">
        {% for Place in Places %}
        <div class="col" style="max-width: 500px; margin: 20px;" id="card-col">
          <div class="card">
            <img src="https://www.yorku.ca/wp-content/uploads/2020/10/welcome-to-york.jpg" class="card-image-top" alt="...">
            <div class="card-body" id="card-body">
              <h5 class="card-title">{{Place.name}}</h5>
              <p class="card-text" id="filter" alt="Dining">{{Place.location}}</p>
              <p class="card-text" id="filter" alt="Cuisine">{{Place.menu_offering}}</p>
              <p id="filter" alt="Payment Type" hidden> {{Place.payment_options}}</p>
              <p id="filter" alt="Dietary" hidden>{{Place.dietary_options}}</p>
              <p class="card-text">
                {% if "Meal Plan (MP)" in Place.payment_options %}
                <strong style="color: red;">Meal Plan!</strong>
                {% endif %}
                {% if "Meal Plan Plus (MP+)" in Place.payment_options %}
                <strong style="color: maroon;">Meal Plan Plus!</strong>
                {% endif %}
                {% if "Meal Plan Taxable" in Place.payment_options %}
                <strong style="color: crimson;">Meal Plan Taxable!</strong>
                {% endif %}
              </p>
              <div class="accordion accordion-flush">
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#hours{{Place.id}}">
                      Hours
                    </button>
                  </h2>
                  <div id="hours{{Place.id}}" class="accordion-collapse collapse">
                    <div class="accordion-body">
                      {% for day, hours in Place.opening_days.items %}
                      {% if day == day_of_week %}
                      <span style="font-weight: bold; color: green;">{{day}} - {{hours}} </span>
                      {% else %}
                      {{day}} - {{hours}}
                      {% endif %}
                      <br>
                      {% endfor %}
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#menu{{Place.id}}">
                      Menu
                    </button>
                  </h2>
                  <div id="menu{{Place.id}}" class="accordion-collapse collapse">
                    <div class="accordion-body">
                      <a href="{{Place.menu_href}}" style="color: red;">{{Place.menu_name}}</a>
                      <br>
                      <a href="{{Place.location_link}}" style="color: maroon">Website</a>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#diet{{Place.id}}">
                      Dietary Options
                    </button>
                  </h2>
                  <div id="diet{{Place.id}}" class="accordion-collapse collapse">
                    <div class="accordion-body">
                      {{Place.dietary_options}}
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#payment{{Place.id}}">
                      Payment Options
                    </button>
                  </h2>
                  <div id="payment{{Place.id}}" class="accordion-collapse collapse">
                    <div class="accordion-body">
                      {{Place.payment_options}}
                    </div>
                  </div>
                </div>
              </div>
              <!-- https://docs.djangoproject.com/en/5.1/ref/templates/builtins/#timesince -->
              <div class="card-footer bg-transparent">
                <small class="text-body-secondary">Last updated {{Place.timestamp | timesince}} ago</small>
              </div>
            </div>
              
          </div>
        </div>
        {% endfor %}
{% endblock %}